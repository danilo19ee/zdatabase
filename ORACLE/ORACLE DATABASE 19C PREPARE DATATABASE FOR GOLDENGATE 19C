+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+   ORACLE DATABASE 19C PREPARE DATATABASE FOR GOLDENGATE 19C	+
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#NOTE
1- Enable database level supplemental logging
2- Force logging should be set to TRUE
3- ENABLE_GOLDENGATE_REPLICATION should be set to true
4- Create ggadmin user
5- Create source user
6- Create target user

#NOTE
The parameter enable_goldengate_replication is not present in the Oracle 12c database and hence it has thrown the erro. Please ignore it.

[oracle@ol7db1 ~]$ sqlplus / as sysdba

SQL*Plus: Release 19.0.0.0.0 - Production on Fri Feb 12 09:35:45 2021
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle.  All rights reserved.


Connected to:
Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.3.0.0.0

SQL> show parameter streams_pool_size

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
streams_pool_size                    big integer 0
SQL>

SQL> alter system set streams_pool_size=1G scope=spfile;

System altered.

SQL> select supplemental_log_data_min, force_logging, log_mode, cdb from v$database;

SUPPLEME FORCE_LOGGING                           LOG_MODE     CDB
-------- --------------------------------------- ------------ ---
NO       NO                                      ARCHIVELOG   YES

SQL> alter database add supplemental log data;

Database altered.

SQL> alter database force logging;

Database altered.

SQL> alter system set enable_goldengate_replication=TRUE;

System altered.

SQL> show parameter enable_goldengate_replication;

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
enable_goldengate_replication        boolean     TRUE

SQL> select supplemental_log_data_min, force_logging, log_mode, cdb from v$database;

SUPPLEME FORCE_LOGGING                           LOG_MODE     CDB
-------- --------------------------------------- ------------ ---
YES      YES                                     ARCHIVELOG   YES

SQL> alter session set "_ORACLE_SCRIPT"=true;

Session altered.

SQL> create user GGADMIN identified by <PASSWORD>;

User created.

SQL> grant create session, alter session to GGADMIN container=all;

Grant succeeded.

SQL> grant alter system to GGADMIN container=all;

Grant succeeded.

SQL> grant connect, resource to GGADMIN container=all;

Grant succeeded.

SQL> grant select any dictionary to GGADMIN container=all;

Grant succeeded.

grant CREATE ANY TABLE to GGADMIN container=all;

SQL> grant CREATE ANY CLUSTER to GGADMIN container=all;

Grant succeeded.

SQL> grant CREATE ANY INDEXTYPE to GGADMIN container=all;

Grant succeeded.

SQL> grant CREATE ANY OPERATOR to GGADMIN container=all;

Grant succeeded.

SQL> grant CREATE ANY PROCEDURE to GGADMIN container=all;

Grant succeeded.

SQL> grant CREATE ANY SEQUENCE to GGADMIN container=all;

Grant succeeded.

SQL> grant CREATE ANY TRIGGER to GGADMIN container=all;

Grant succeeded.

SQL> grant CREATE ANY TYPE to GGADMIN container=all;

Grant succeeded.

SQL> grant ALTER ANY table to GGADMIN container=all;

Grant succeeded.

SQL> grant flashback any table to GGADMIN container=all;

Grant succeeded.

SQL> grant select any table to GGADMIN container=all;

Grant succeeded.

SQL> grant insert any table to GGADMIN container=all;

Grant succeeded.

SQL> grant update any table to GGADMIN container=all;

Grant succeeded.

SQL> grant delete any table to GGADMIN container=all;

Grant succeeded.

SQL> grant select on dba_clusters to GGADMIN container=all;

Grant succeeded.

SQL> grant execute on dbms_flashback to GGADMIN container=all;

Grant succeeded.

SQL> grant select any transaction to GGADMIN container=all;

Grant succeeded.

SQL> grant select_catalog_role to GGADMIN container=all;

Grant succeeded.

SQL> grant dba to GGADMIN container=all;

Grant succeeded.

SQL> grant unlimited tablespace to GGADMIN container=all;

Grant succeeded.

SQL> GRANT SET CONTAINER TO GGADMIN;

Grant succeeded.

SQL> GRANT SELECT ON SYS.V_$DATABASE TO GGADMIN CONTAINER=ALL;

Grant succeeded.

SQL> EXEC DBMS_STREAMS_AUTH.GRANT_ADMIN_PRIVILEGE('GGADMIN');

PL/SQL procedure successfully completed.

SQL> GRANT BECOME USER TO GGADMIN container=all;

Grant succeeded.

SQL> exec DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE (grantee=> 'GGADMIN', privilege_type=> 'capture', grant_select_privileges =>true, do_grants=>TRUE, container=>'ALL');

PL/SQL procedure successfully completed.

SQL> exec DBMS_GOLDENGATE_AUTH.GRANT_ADMIN_PRIVILEGE (grantee=> 'GGADMIN', privilege_type=> 'apply', grant_select_privileges =>true, do_grants=>TRUE, container=>'ALL');

PL/SQL procedure successfully completed.

SQL> alter user GGADMIN set container_data=ALL container=CURRENT;

User altered.

SQL> select * from dba_sys_privs where grantee='GGADMIN';

GRANTEE PRIVILEGE                                ADM COM INH
------- ---------------------------------------- --- --- ---
GGADMIN EXECUTE ANY RULE                         YES NO  NO
GGADMIN CREATE JOB                               NO  NO  NO
GGADMIN ALTER SESSION                            NO  NO  NO
GGADMIN LOGMINING                                NO  NO  NO
GGADMIN DROP ANY EDITION                         NO  NO  NO
GGADMIN CREATE ANY RULE SET                      YES NO  NO
GGADMIN CREATE EVALUATION CONTEXT                YES NO  NO
GGADMIN DEQUEUE ANY QUEUE                        YES NO  NO
GGADMIN ENQUEUE ANY QUEUE                        YES NO  NO
GGADMIN CREATE RULE                              YES NO  NO
GGADMIN RESTRICTED SESSION                       NO  NO  NO
GGADMIN FLASHBACK ANY TABLE                      NO  NO  NO
GGADMIN SELECT ANY TABLE                         NO  NO  NO
GGADMIN ALTER ANY TABLE                          NO  NO  NO
GGADMIN ALTER ANY RULE                           YES NO  NO
GGADMIN MANAGE ANY QUEUE                         YES NO  NO
GGADMIN CREATE ANY EDITION                       NO  NO  NO
GGADMIN EXECUTE ANY RULE SET                     YES NO  NO
GGADMIN CREATE RULE SET                          YES NO  NO
GGADMIN SET CONTAINER                            NO  NO  NO
GGADMIN CREATE ANY RULE                          YES NO  NO
GGADMIN ALTER ANY RULE SET                       YES NO  NO
GGADMIN ALTER SYSTEM                             NO  YES NO
GGADMIN SELECT ANY TRANSACTION                   NO  YES NO
GGADMIN CREATE JOB                               NO  YES NO
GGADMIN DELETE ANY TABLE                         NO  YES NO
GGADMIN ALTER SESSION                            NO  YES NO
GGADMIN LOGMINING                                NO  YES NO
GGADMIN CREATE EVALUATION CONTEXT                YES YES NO
GGADMIN DEQUEUE ANY QUEUE                        YES YES NO
GGADMIN CREATE ANY PROCEDURE                     NO  YES NO
GGADMIN UPDATE ANY TABLE                         NO  YES NO
GGADMIN BECOME USER                              NO  YES NO
GGADMIN CREATE RULE                              YES YES NO
GGADMIN INSERT ANY TABLE                         NO  YES NO
GGADMIN FLASHBACK ANY TABLE                      NO  YES NO
GGADMIN SELECT ANY DICTIONARY                    NO  YES NO
GGADMIN CREATE ANY SEQUENCE                      NO  YES NO
GGADMIN SELECT ANY TABLE                         NO  YES NO
GGADMIN ALTER ANY TABLE                          NO  YES NO
GGADMIN CREATE ANY OPERATOR                      NO  YES NO
GGADMIN UNLIMITED TABLESPACE                     NO  YES NO
GGADMIN CREATE SESSION                           NO  YES NO
GGADMIN EXECUTE ANY RULE SET                     YES YES NO
GGADMIN CREATE RULE SET                          YES YES NO
GGADMIN CREATE ANY TRIGGER                       NO  YES NO
GGADMIN CREATE ANY CLUSTER                       NO  YES NO
GGADMIN CREATE ANY INDEXTYPE                     NO  YES NO
GGADMIN CREATE ANY TYPE                          NO  YES NO

49 rows selected.

SQL> alter session set container=APPSPDB;

Session altered.

SQL> create user SOURCE identified by <PASSWORD>;

User created.

SQL> grant connect, resource, create session, alter session to SOURCE;

Grant succeeded.

SQL> grant unlimited tablespace to SOURCE;

Grant succeeded.

SQL> create user TARGET identified by <PASSWORD>;

User created.

SQL> grant connect, resource, create session, alter session to TARGET;

Grant succeeded.

SQL> grant unlimited tablespace to TARGET;

Grant succeeded.

#OBJECT CREATED TO EXECUTE EXAMPLE
SQL> create table source.employee (id number not null, name varchar2(50), joindate date);

Table created.

SQL> create table target.employee (id number not null, name varchar2(50), joindate date);

Table created.

SQL> desc source.employee;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 ID                                        NOT NULL NUMBER
 NAME                                               VARCHAR2(50)
 JOINDATE                                           DATE

SQL> desc target.employee;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 ID                                        NOT NULL NUMBER
 NAME                                               VARCHAR2(50)
 JOINDATE                                           DATE

#CONFIGURE EXTRACT AND REPLICAT PROCESSES

#OPEN THE SERVICE CONSOLE MANAGER

http://192.168.1.130:7820/?root=account
#OR
http://localhost:7820/?root=account

				Oracle GoldenGate Service Manager
				User Name	oggadmin
				Password	**************

#CLICK ON ADMINISTRATION SERVER TO CONFIGURE EXTRACT/REPLICAT PROCESS

Services	|	Running 4	|	Failed 0	| Other 0

	Deployment All

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|	Deployment		|		Service				|	Port			|	Status			|	Action			|		Details				|
|	DeploymentOGGMA		|	 	Administration Server		|	8001 <-Click 		|	Running			|	Action			|						|
|	DeploymentOGGMA		|		Distribution Server		|	8002			|	Running			|	Action			|						|
| 	DeploymentOGGMA		|		Performance Metrics Server	|	8004			|	Running			|	Action			|						|
| 	DeploymentOGGMA		|		Receiver Server			|	8003			|	Running			|	Action			|						|
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

	Deployments

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|	Deployment		|		GoldenGate Home		|	Status			|	Running Service		|		Not Running Services	|	Action	|
|	DeploymentOGGMA		|/u01/app/oracle/product/ggma		|	Running			|	4			|		0			|	Action	|
|	ServiceManager		|/u01/app/oracle/product/ggma		|	Running			|	0			|		0			|	Action	|
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

http://192.168.1.130:8001/

				Oracle GoldenGate Service Manager
				User Name	oggadmin
				Password	**************
#NOTE
In my test environment I defined port 8001 but the default port is 7001
#CLICK ON THE + SYMBOL TO ADD EXTRACT PROCESS.

Extracts	|	Running 0	|	Failed 0	| Other 0				Click-> +		|	Replicats	|	Running 0	|	Failed 0	| Other 0				+

Critical Events
___________________ [Refresh]

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|	Code			|	Date			|	Severity		|	Message										|
|	OGG-08100		| 2/7/21 9:13:45 PM		|	OK			|	Oracle GoldenGate Administration Server for Oracle: Service started.		|
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

http://192.168.1.130:8001/?root=status&process=addExtract

#NOTE
Only Integrated Extraction supports multi-tenant databases, the classic does not

Overview > Add Extract

	Add Extract

	(1)____________________________________________________________________________(2)_____________________________________________________________________________(3)
	Extract Type 									Extract Options									Parameter File

	
	(*) Integrated Extract
	( ) Classic Extract
	( ) Initial Load Extract

http://192.168.1.130:8001/?root=status&process=addExtract

#NOTE
Enter the extract name and enable log retention if you want to register the extract with RMAN. 
This makes the RMAN to retain the log files required by extract process

#NOTE
In Microservices Architecture, normal userid dblogin is not supported. 
The default login is using alias stored in credential.
First add credentialstore, enter the username details and click submit.

#NOTE
Enter the domain and alias that was created in previous step. 
Give a name to trail file and Click Next

Overview > Add Extract

	Add Extract

	(1)____________________________________________________________________________(2)_____________________________________________________________________________(3)
	Extract Type 									Extract Options									Parameter File	
	
	Basic Information
	
				Process Name ?:				ggma19ci
				Description ?:
				Intent ?: 				Unidirectional
				Log Retention ?: 
								
									Create new credential

				Credential Domain:			oggadmin
				Credential Alias:			ggadmin
				User ID:				ggadmin
				Password:				<PASSWORD>
				Verify Password:			<PASSWORD>
				
									Submit <-Click								
									
				Credential Domain:			oggadmin
				Credential Alias:			ggadmin
				Begin:					Now
				Now
				Trail Name:				gi
				Trail Subdirectory:
				Trail Size (MB):
				Trail Sequence:
				Trail Offset:
				Thread Number:
	
	 Encryption Profile
	 
				Profile Name:				LocalWallet (Default)
				Encryption Profile Type:		Local Wallet
				Masterkey Name:				OGG_DEFAULT_MASTERKEY
	
	Managed Options
	
				Profile Name:				Default (Default)
				Critical to deployment health ?:
				Auto Start ?:
				Auto Restart ?:
	
	Registration Information
					
				CSN ?:
				Share ?: 				Automatic
				Optimized ?:				
				Register to PDBs:			APPSPDB
				Downstream Capture:


http://192.168.1.130:8001/?root=status&process=addExtract

#NOTE
This will show the parameter file. Add the tables which you want to capture. 
We have added all tables under schema source. Now click the button "Create and Run".

Overview > Add Extract

	Add Extract

	(1)____________________________________________________________________________(2)_____________________________________________________________________________(3)
	Extract Type 									Extract Options									Parameter File	

	Parameter File 
	
	extract ggma19ci
	useridalias ggadmin domain oggadmin
	exttrail gi
	sourcecatalog appspdb
	table source.*;

									Register Extract in the background?
									
				[Back]															[Create]	[Create and Run] <-Click


#ADD DISTRIBUITION SERVER
#NOTE
In the Service Manager console, click the Distribuition Server

#OPEN THE SERVICE CONSOLE MANAGER

http://192.168.1.130:7820/?root=account
#OR
http://localhost:7820/?root=account

				Oracle GoldenGate Service Manager
				User Name	oggadmin
				Password	**************

#CLICK ON DISTRIBUITION SERVER

Services	|	Running 4	|	Failed 0	| Other 0

	Deployment All

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|	Deployment		|		Service				|	Port			|	Status			|	Action			|		Details				|
|	DeploymentOGGMA		|	 	Administration Server		|	8001 	 		|	Running			|	Action			|						|
|	DeploymentOGGMA		|		Distribution Server		|	8002 <- Click		| 	Running			|	Action			|						|
| 	DeploymentOGGMA		|		Performance Metrics Server	|	8004			|	Running			|	Action			|						|
| 	DeploymentOGGMA		|		Receiver Server			|	8003			|	Running			|	Action			|						|
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

	Deployments

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|	Deployment		|		GoldenGate Home		|	Status			|	Running Service		|		Not Running Services	|	Action	|
|	DeploymentOGGMA		|/u01/app/oracle/product/ggma		|	Running			|	4			|		0			|	Action	|
|	ServiceManager		|/u01/app/oracle/product/ggma		|	Running			|	0			|		0			|	Action	|
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

http://192.168.1.130:8002/

				Oracle GoldenGate Service Manager
				User Name	oggadmin
				Password	**************

Paths	|	Running 0	|	Failed 0	| Other 0				Click-> +

http://192.168.1.130:8002/?root=status&path=addPath

Overview > Add Path

	Add Path
	
				Path Name:			EXPUMP
				Description:
				Reverse proxy enabled?
				Use Basic Authentication:
				Source:				GGMA19CI		
						Trail Name	gi
				Generated Source URI: 		trail://192.168.1.130:8002/services/v2/sources?trail=gi
				Target: ?			ogg		
						Target Host	192.168.1.130
						Port Number	8003
						Trail Name	ri
				Generated Source URI: 		ogg://192.168.1.130:8003/services/v2/targets?trail=ri
				Target Encryption Algorithm: 	NONE
				Enable Network Compression:
				Sequence Length:		9
				Trail Size (MB):		500
								
								Encryption Profile
				Profile Name:			LocalWallet (Default)
				Encryption Profile Type:	Local Wallet
				Masterkey Name:			OGG_DEFAULT_MASTERKEY
				Target Type:			( ) Manager	( ) Collector	(*) Receiver Server
				Begin: ?			Position in Log
				Source Sequence Number:		0
				Source RBA Offset:		0
				Critical: ?
				Auto Restart: ?
				
	Rule-set Configuration
	
				Filtering ? 
				
	More Options
	
				EOF Delay (centiseconds): ? 	100
				
	App Options		
				
				TCP Flush Bytes: ? 
				TCP Flush Seconds: ?
				
	TCP Options
			
				DSCP: ?				DEFAULT
				TOS: ?				DEFAULT
				TCP_NODELAY: ? 
				Quick ACK: ?
				TCP_CORK: ?
				System Send Buffer Size: ? 
				System Recieve Buffer Size: ?
				Keep Alive: ? 
				
				[Cancel]	[Create Path]		[Create and Run]
				
#NOTE
Now the pump is added and it will be received by Receiver server running on port 8003
Now you are going to add the replicat process.

#OPEN THE SERVICE CONSOLE MANAGER

http://192.168.1.130:7820/?root=account
#OR
http://localhost:7820/?root=account

				Oracle GoldenGate Service Manager
				User Name	oggadmin
				Password	**************

#CLICK ON ADMINISTRATION SERVER TO CONFIGURE EXTRACT/REPLICAT PROCESS

Services	|	Running 4	|	Failed 0	| Other 0

	Deployment All

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|	Deployment		|		Service				|	Port			|	Status			|	Action			|		Details				|
|	DeploymentOGGMA		|	 	Administration Server		|	8001 <-Click 		|	Running			|	Action			|						|
|	DeploymentOGGMA		|		Distribution Server		|	8002			|	Running			|	Action			|						|
| 	DeploymentOGGMA		|		Performance Metrics Server	|	8004			|	Running			|	Action			|						|
| 	DeploymentOGGMA		|		Receiver Server			|	8003			|	Running			|	Action			|						|
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

	Deployments

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|	Deployment		|		GoldenGate Home		|	Status			|	Running Service		|		Not Running Services	|	Action	|
|	DeploymentOGGMA		|/u01/app/oracle/product/ggma		|	Running			|	4			|		0			|	Action	|
|	ServiceManager		|/u01/app/oracle/product/ggma		|	Running			|	0			|		0			|	Action	|
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

http://192.168.1.130:8001/

				Oracle GoldenGate Service Manager
				User Name	oggadmin
				Password	**************
#NOTE
In my test environment I defined port 8001 but the default port is 7001
#CLICK ON THE + SYMBOL TO ADD REPLICAT PROCESS.

Extracts	|	Running 1	|	Failed 0	| Other 0			+		|	Replicats	|	Running 0	|	Failed 0	| Other 0		+ <- Click

Critical Events
___________________ [Refresh]

http://192.168.1.130:8001/?root=status&process=addReplicat

Overview > Add Replicat

	Add Replicat

	(1)____________________________________________________________________________(2)_____________________________________________________________________________(3)
	Replicat Type 									Replicat Options								Parameter File

	
	(*) Integrated Replicat
	( ) Nonintegrated Replicat
	( ) Coordinated Replicat
	( ) Parallel Replicat

Overview > Add Extract

	Add Extract

	(1)____________________________________________________________________________(2)_____________________________________________________________________________(3)
	Replicat Type 									Replicat Options								Parameter File
	
	Basic Information				
	
				Process Name: ?				ggma19ri
				Description: ?
				Intent: ? 				Unidirectional
	
				Create new credential
	
				Credential Domain: ?			oggadmin
				Credential Alias: ?			ggadmin
				Begin: ? 				Position in Log
				Transaction Log Sequence Number ?	0
				Transaction Log RBA Offset ?		0
				Source: ?				Trail
				Trail Name: ?				ri
				Trail Subdirectory: ?
				Checkpoint Table: ?			No Checkpoint Table
	
	Encryption Profile

				Profile Name:				LocalWallet (Default)
				Encryption Profile Type: 		LocalWallet
				Masterkey Name:				OGG_DEFAULT_MASTERKEY
	
	Managed Options

				Profile Name:				Default (Default)
				Critical to deployment health:
				Auto Start: ?
				Auto Restart: ?		
	
		[Back]							[Next] <- Click
		
Overview > Add Extract

	Add Extract

	(1)____________________________________________________________________________(2)_____________________________________________________________________________(3)
	Replicat Type 									Replicat Options								Parameter File
	
	Parameter File 
	
	replicat ggma19ri
	useridalias ggadmin domain oggadmin
	sourcecatalog appspdb
	MAP source.*, TARGET target.*;

	-- If performing precise instantiation after an Initial Load as of a SCN
	-- Run the replicat with a start option to only start apply after the SCN at which the initial load was performed.
	-- Example Replicat->Start Option->After CSN with SCN value used for the Initial Load.
	-- See start options for running a replicat for more details.

									Register Extract in the background?
									
				[Back]															[Create]	[Create and Run] <-Click












